// 이해도 - 80%
#include <stdio.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h> 

int printAddr(struct sockaddr_in*);
int main(int argc, char** argv)
{
	char* sampleIP = "127.0.0.1";
	int port = 9002;

	struct sockaddr_in sockAddr1, sockAddr2, sockAddr3;

	sockAddr1.sin_family = AF_INET; // IPv4 사용
	sockAddr1.sin_addr.s_addr = inet_addr(sampleIP); // IPv4를 Network byte order로 변환 => 빅엔디안
	sockAddr1.sin_port = htons(port); // host-to-network =>빅엔디안

	sockAddr2.sin_family = AF_INET;
	inet_aton(sampleIP, &(sockAddr2.sin_addr)); // IPv4를 network byte order로 변환 후 구조체 전달 => 빅엔디안
	sockAddr2.sin_port = htons(port);

	sockAddr3.sin_family = AF_INET;
	inet_pton(AF_INET, sampleIP, &(sockAddr3.sin_addr)); // IPv4를 ASCII string으로 변환 하여 구조체에 저장
	sockAddr3.sin_port = htons(port);

	printAddr(&sockAddr1);
	printAddr(&sockAddr2);
	printAddr(&sockAddr3);

	printf("============ntoa==============\n");
	printf("IP:%s \n", inet_ntoa(sockAddr1.sin_addr)); // network byte order -> IPv4 변환
	printf("IP:%s \n", inet_ntoa(sockAddr2.sin_addr));
	printf("IP:%s \n", inet_ntoa(sockAddr3.sin_addr));

	return 0;
}
int printAddr(struct sockaddr_in* myAddr)
{
	int port;
	char txt[INET_ADDRSTRLEN];
	port = ntohs(myAddr->sin_port);	//리틀엔디안
	inet_ntop(AF_INET, &(((struct sockaddr_in*)myAddr)->sin_addr), txt, sizeof(struct sockaddr_in));	//리틀엔디안
	printf("IP:%s, Port:%d \n", txt, port);
	return 0;
}